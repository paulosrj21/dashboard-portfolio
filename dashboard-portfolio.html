<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard de Gestão de Portfólio</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .tab-button.active {
            border-bottom-color: #3b82f6;
            color: #3b82f6;
            font-weight: 600;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        .farol-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            display: inline-block;
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">

    <div class="container mx-auto p-4 sm:p-6 lg:p-8">
        <header class="mb-8">
            <h1 class="text-3xl font-bold text-gray-900">Dashboard de Gestão de Portfólio</h1>
            <p class="text-gray-600 mt-1">Visão integrada das iniciativas e métricas de fluxo.</p>
        </header>

        <div class="border-b border-gray-200 mb-6">
            <nav class="-mb-px flex space-x-6" aria-label="Tabs">
                <button onclick="changeTab('metrics')" class="tab-button active whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm" data-tab="metrics">
                    Métricas de Fluxo
                </button>
                <button onclick="changeTab('summary')" class="tab-button whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm text-gray-500 hover:text-gray-700 hover:border-gray-300" data-tab="summary">
                    Sumário de Projetos
                </button>
                <button onclick="changeTab('matrix')" class="tab-button whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm text-gray-500 hover:text-gray-700 hover:border-gray-300" data-tab="matrix">
                    Matriz de Priorização
                </button>
            </nav>
        </div>

        <main>
            <div id="metrics-content" class="tab-content active">
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
                    <div class="bg-white p-5 rounded-lg shadow-sm border border-gray-100">
                        <h3 class="text-sm font-medium text-gray-500">Taxa de Entrada</h3>
                        <p id="taxa-entrada-valor" class="mt-2 text-3xl font-bold">-</p>
                        <p class="text-xs text-gray-400 mt-1">Iniciativas novas ÷ período</p>
                        <p id="taxa-entrada-desc" class="text-xs text-gray-600 mt-2">Novas iniciativas (últimos 30 dias).</p>
                    </div>
                    <div class="bg-white p-5 rounded-lg shadow-sm border border-gray-100">
                        <h3 class="text-sm font-medium text-gray-500">Taxa de Saída</h3>
                        <p id="taxa-saida-valor" class="mt-2 text-3xl font-bold">-</p>
                        <p class="text-xs text-gray-400 mt-1">Iniciativas concluídas ÷ período</p>
                        <p id="taxa-saida-desc" class="text-xs text-gray-600 mt-2">Iniciativas concluídas (últimos 30 dias).</p>
                    </div>
                    <div class="bg-white p-5 rounded-lg shadow-sm border border-gray-100">
                        <h3 class="text-sm font-medium text-gray-500">Velocidade (Throughput)</h3>
                        <p id="throughput-valor" class="mt-2 text-3xl font-bold">-</p>
                        <p class="text-xs text-gray-400 mt-1">Média de entregas / ciclo</p>
                         <p id="throughput-desc" class="text-xs text-gray-600 mt-2">Média mensal de entregas.</p>
                    </div>
                    <div class="bg-white p-5 rounded-lg shadow-sm border border-gray-100">
                        <h3 class="text-sm font-medium text-gray-500">Lead Time Médio</h3>
                        <p id="lead-time-valor" class="mt-2 text-3xl font-bold">-</p>
                        <p class="text-xs text-gray-400 mt-1">(Data fim – Data início) médio</p>
                        <p id="lead-time-desc" class="text-xs text-gray-600 mt-2">Tempo médio do início ao fim.</p>
                    </div>
                    <div class="bg-white p-5 rounded-lg shadow-sm border border-gray-100">
                        <h3 class="text-sm font-medium text-gray-500">Cycle Time Médio</h3>
                        <p id="cycle-time-valor" class="mt-2 text-3xl font-bold">-</p>
                        <p class="text-xs text-gray-400 mt-1">Tempo médio em cada etapa</p>
                        <p id="cycle-time-desc" class="text-xs text-gray-600 mt-2">Média da coluna 'cycle_time'.</p>
                    </div>
                    <div class="bg-white p-5 rounded-lg shadow-sm border border-gray-100">
                        <h3 class="text-sm font-medium text-gray-500">Backlog Transportado (WIP)</h3>
                        <p id="wip-valor" class="mt-2 text-3xl font-bold">-</p>
                        <p class="text-xs text-gray-400 mt-1">Iniciativas abertas no fim do mês</p>
                        <p id="wip-desc" class="text-xs text-gray-600 mt-2">Total de iniciativas em andamento.</p>
                    </div>
                    <div class="bg-white p-5 rounded-lg shadow-sm border border-gray-100">
                        <h3 class="text-sm font-medium text-gray-500">Idade Média (Aging)</h3>
                        <p id="aging-valor" class="mt-2 text-3xl font-bold">-</p>
                        <p class="text-xs text-gray-400 mt-1">Média de dias desde a entrada</p>
                        <p id="aging-desc" class="text-xs text-gray-600 mt-2">Para itens ainda não concluídos.</p>
                    </div>
                     <div class="bg-white p-5 rounded-lg shadow-sm border border-gray-100">
                        <h3 class="text-sm font-medium text-gray-500">Taxa de Aprovação</h3>
                        <p id="aprovacao-valor" class="mt-2 text-3xl font-bold">-</p>
                        <p class="text-xs text-gray-400 mt-1">Aprovadas ÷ triadas</p>
                        <p id="aprovacao-desc" class="text-xs text-gray-600 mt-2">Percentual de iniciativas aprovadas.</p>
                    </div>
                     <div class="bg-white p-5 rounded-lg shadow-sm border border-gray-100">
                        <h3 class="text-sm font-medium text-gray-500">Taxa de Descarte</h3>
                        <p id="descarte-valor" class="mt-2 text-3xl font-bold">-</p>
                        <p class="text-xs text-gray-400 mt-1">Rejeitadas ÷ triadas</p>
                        <p id="descarte-desc" class="text-xs text-gray-600 mt-2">Percentual de iniciativas descartadas.</p>
                    </div>
                    <div class="bg-white p-5 rounded-lg shadow-sm border border-gray-100 col-span-1 sm:col-span-2 lg:col-span-2">
                        <h3 class="text-sm font-medium text-gray-500">Extrato por Relevância</h3>
                        <canvas id="complexityChart" class="mt-4"></canvas>
                    </div>
                </div>
            </div>

            <div id="summary-content" class="tab-content">
                <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-100 overflow-x-auto">
                    <table class="w-full text-sm text-left text-gray-500">
                        <thead class="text-xs text-gray-700 uppercase bg-gray-50">
                            <tr>
                                <th scope="col" class="px-6 py-3">Iniciativa</th>
                                <th scope="col" class="px-6 py-3">Responsável</th>
                                <th scope="col" class="px-6 py-3">Fluxo</th>
                                <th scope="col" class="px-6 py-3">Progresso</th>
                                <th scope="col" class="px-6 py-3">Farol</th>
                                <th scope="col" class="px-6 py-3">Status</th>
                                <th scope="col" class="px-6 py-3">GP</th>
                            </tr>
                        </thead>
                        <tbody id="projects-table-body">
                        </tbody>
                    </table>
                </div>
            </div>

            <div id="matrix-content" class="tab-content">
                 <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-100 mb-6">
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div>
                            <label for="filter-gp" class="block text-sm font-medium text-gray-700">Filtrar por GP</label>
                            <select id="filter-gp" class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md">
                                <option>Todos</option>
                            </select>
                        </div>
                        <div>
                            <label for="filter-area" class="block text-sm font-medium text-gray-700">Filtrar por Área</label>
                            <select id="filter-area" class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md">
                                <option>Todos</option>
                            </select>
                        </div>
                         <div>
                            <label for="filter-status" class="block text-sm font-medium text-gray-700">Filtrar por Status</label>
                             <select id="filter-status" class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md">
                                <option>Todos</option>
                                <option>Em dia</option>
                                <option>Oportunidade</option>
                                <option>Atenção</option>
                                <option>Impedido</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="grid grid-cols-4 gap-1">
                    <div class="p-2 text-center font-bold"></div>
                    <div class="p-2 text-center font-bold text-sm bg-gray-100 rounded-t-lg">Baixa (1)</div>
                    <div class="p-2 text-center font-bold text-sm bg-gray-100 rounded-t-lg">Média (2)</div>
                    <div class="p-2 text-center font-bold text-sm bg-gray-100 rounded-t-lg">Alta (3)</div>
                    
                    <div class="p-2 text-center font-bold text-sm bg-gray-100 rounded-l-lg self-center">Forte (3)</div>
                    <div id="cell-3-1" class="bg-yellow-100 rounded-lg p-3 min-h-[150px] border-2 border-dashed border-yellow-200"></div>
                    <div id="cell-3-2" class="bg-green-100 rounded-lg p-3 min-h-[150px] border-2 border-dashed border-green-200"></div>
                    <div id="cell-3-3" class="bg-red-100 rounded-lg p-3 min-h-[150px] border-2 border-dashed border-red-200"></div>
                    
                    <div class="p-2 text-center font-bold text-sm bg-gray-100 rounded-l-lg self-center">Médio (2)</div>
                    <div id="cell-2-1" class="bg-blue-100 rounded-lg p-3 min-h-[150px] border-2 border-dashed border-blue-200"></div>
                    <div id="cell-2-2" class="bg-yellow-100 rounded-lg p-3 min-h-[150px] border-2 border-dashed border-yellow-200"></div>
                    <div id="cell-2-3" class="bg-green-100 rounded-lg p-3 min-h-[150px] border-2 border-dashed border-green-200"></div>
                    
                    <div class="p-2 text-center font-bold text-sm bg-gray-100 rounded-l-lg self-center">Fraco (1)</div>
                    <div id="cell-1-1" class="bg-gray-200 rounded-lg p-3 min-h-[150px] border-2 border-dashed border-gray-300"></div>
                    <div id="cell-1-2" class="bg-blue-100 rounded-lg p-3 min-h-[150px] border-2 border-dashed border-blue-200"></div>
                    <div id="cell-1-3" class="bg-yellow-100 rounded-lg p-3 min-h-[150px] border-2 border-dashed border-yellow-200"></div>
                </div>
            </div>
        </main>
    </div>

    <script>
    // --- DADOS ---
        let projectsData = [];
    
        // Função para converter data DD/MM/YYYY para um objeto Date
        function parseDate(dateStr) {
            if (!dateStr || typeof dateStr !== 'string') return null;
            const parts = dateStr.split('/');
            if (parts.length === 3) {
                // Formato DD/MM/YYYY
                return new Date(parts[2], parts[1] - 1, parts[0]);
            }
            return new Date(dateStr); // Tenta formato padrão
        }
    
        async function carregarDadosDaPlanilha() {
            const urlPlanilha = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQBgoOo6EBhtoY_n3pkqoUHLNDJtrFx0j_9H32mqIdYWIY5CY13BW5kjl6GlNtgyMU4jU7vSUKrvYCw/pub?gid=0&single=true&output=csv'; 
            
            try {
                const resposta = await fetch(urlPlanilha);
                if (!resposta.ok) throw new Error(`Erro na rede: ${resposta.statusText}`);
                
                const textoCsv = await resposta.text();
                const linhas = textoCsv.trim().split(/\r?\n/);
    
                // CORREÇÃO APLICADA AQUI: Usando um Regex para separar as colunas,
                // que ignora ponto e vírgulas dentro de aspas duplas.
                const csvRegex = /;(?=(?:(?:[^"]*"){2})*[^"]*$)/;
    
                const cabecalho = linhas[0].split(csvRegex).map(h => h.trim());
    
                const dadosJson = linhas.slice(1).map(linha => {
                    // CORREÇÃO APLICADA AQUI TAMBÉM
                    const valores = linha.split(csvRegex);
                    const obj = {};
                    cabecalho.forEach((chave, i) => {
                        let valor = valores[i] ? valores[i].trim() : '';
                        // Remove as aspas do início e do fim, se existirem
                        if (valor.startsWith('"') && valor.endsWith('"')) {
                            valor = valor.substring(1, valor.length - 1);
                        }
                        const colunasNumericas = ['id', 'progresso', 'prioridade', 'impacto', 'cycle_time'];
                        if (colunasNumericas.includes(chave) && valor !== '' && !isNaN(Number(valor))) {
                            obj[chave] = Number(valor);
                        } else {
                            obj[chave] = valor;
                        }
                    });
                    return obj;
                });
                return dadosJson;
    
            } catch (error) {
                console.error('Erro ao buscar dados da planilha:', error);
                return [];
            }
        }
    
        // --- LÓGICA DAS ABAS ---
        function changeTab(tabName) {
            document.querySelectorAll('.tab-button').forEach(button => {
                button.classList.remove('active');
                if (button.dataset.tab === tabName) button.classList.add('active');
            });
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            document.getElementById(`${tabName}-content`).classList.add('active');
        }
    
        // --- RENDERIZAÇÃO ---
        
        // Métricas da Aba 1
        function calculateAndRenderMetrics(data) {
            const today = new Date();
            const thirtyDaysAgo = new Date(today.getFullYear(), today.getMonth(), today.getDate() - 30);
            
            // 1. Taxa de Entrada
            const newInitiatives = data.filter(p => p.data_entrada && parseDate(p.data_entrada) >= thirtyDaysAgo);
            document.getElementById('taxa-entrada-valor').innerText = newInitiatives.length;
    
            // 2. Taxa de Saída
            const completedInitiatives = data.filter(p => p.data_fim && parseDate(p.data_fim) >= thirtyDaysAgo);
            document.getElementById('taxa-saida-valor').innerText = completedInitiatives.length;
    
            // 3. Velocidade (Throughput) - Média mensal
            const completedEver = data.filter(p => p.data_fim);
            const firstCompletion = completedEver.length > 0 ? completedEver.map(p => parseDate(p.data_fim)).sort((a,b) => a - b)[0] : new Date();
            const monthsElapsed = (today.getFullYear() - firstCompletion.getFullYear()) * 12 + (today.getMonth() - firstCompletion.getMonth()) + 1;
            const throughput = completedEver.length / (monthsElapsed || 1);
            document.getElementById('throughput-valor').innerText = `${throughput.toFixed(1)}/mês`;
    
            // 4. Lead Time Médio
            const withLeadTime = data.filter(p => p.data_inicio && p.data_fim);
            const totalLeadTime = withLeadTime.reduce((sum, p) => {
                const diff = parseDate(p.data_fim) - parseDate(p.data_inicio);
                return sum + (diff / (1000 * 60 * 60 * 24)); // em dias
            }, 0);
            const avgLeadTime = withLeadTime.length > 0 ? totalLeadTime / withLeadTime.length : 0;
            document.getElementById('lead-time-valor').innerText = `${avgLeadTime.toFixed(0)} dias`;
    
            // 5. Cycle Time Médio
            const withCycleTime = data.filter(p => typeof p.cycle_time === 'number');
            const totalCycleTime = withCycleTime.reduce((sum, p) => sum + p.cycle_time, 0);
            const avgCycleTime = withCycleTime.length > 0 ? totalCycleTime / withCycleTime.length : 0;
            document.getElementById('cycle-time-valor').innerText = `${avgCycleTime.toFixed(1)} dias`;
    
            // 6. Backlog Transportado (WIP)
            const wip = data.filter(p => p.data_inicio && !p.data_fim);
            document.getElementById('wip-valor').innerText = wip.length;
            
            // 7. Idade Média (Aging)
            const wipItems = data.filter(p => p.data_entrada && !p.data_fim);
            const totalAge = wipItems.reduce((sum, p) => {
                const diff = today - parseDate(p.data_entrada);
                return sum + (diff / (1000 * 60 * 60 * 24)); // em dias
            }, 0);
            const avgAge = wipItems.length > 0 ? totalAge / wipItems.length : 0;
            document.getElementById('aging-valor').innerText = `${avgAge.toFixed(0)} dias`;
            
            // 8 & 9. Taxa de Aprovação e Descarte
            const screened = data.filter(p => p.triada && (p.triada.toString().toLowerCase() === 'true' || p.triada === '1'));
            const approved = screened.filter(p => p.aprovada && (p.aprovada.toString().toLowerCase() === 'true' || p.aprovada === '1'));
            const approvalRate = screened.length > 0 ? (approved.length / screened.length) * 100 : 0;
            const rejectionRate = 100 - approvalRate;
            document.getElementById('aprovacao-valor').innerText = `${approvalRate.toFixed(0)}%`;
            document.getElementById('descarte-valor').innerText = `${rejectionRate.toFixed(0)}%`;
        }
    
        // Gráfico da Aba 1
        function renderComplexityChart() {
            const ctx = document.getElementById('complexityChart').getContext('2d');
            const projectCounts = projectsData.reduce((acc, p) => {
                const score = (p.prioridade || 0) + (p.impacto || 0);
                if (score <= 3) acc['Baixa Relevância'] = (acc['Baixa Relevância'] || 0) + 1;
                else if (score === 4) acc['Oportunidade Tática'] = (acc['Oportunidade Tática'] || 0) + 1;
                else if (score >= 5) acc['Alta Prioridade'] = (acc['Alta Prioridade'] || 0) + 1;
                return acc;
            }, {});
    
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: Object.keys(projectCounts),
                    datasets: [{
                        label: 'Nº de Iniciativas',
                        data: Object.values(projectCounts),
                        backgroundColor: [
                            'rgba(156, 163, 175, 0.7)',
                            'rgba(251, 191, 36, 0.7)',
                            'rgba(59, 130, 246, 0.7)',
                        ],
                        borderColor: [
                            'rgba(156, 163, 175, 1)',
                            'rgba(251, 191, 36, 1)',
                            'rgba(59, 130, 246, 1)',
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    },
                    plugins: {
                        legend: {
                            display: false,
                        },
                        title: {
                            display: false
                        }
                    }
                }
            });
        }
    
        // Tabela da Aba 2
        function renderSummaryTable() {
            const tableBody = document.getElementById('projects-table-body');
            tableBody.innerHTML = '';
            const farolColors = {
                'Em dia': 'bg-green-500',
                'Oportunidade': 'bg-blue-500',
                'Atenção': 'bg-yellow-400',
                'Impedido': 'bg-red-500',
                'Descartado': 'bg-gray-400'
            };
    
            projectsData.forEach(p => {
                const progressPercentage = ((p.progresso || 0) * 100).toFixed(0);
                const row = `
                    <tr class="bg-white border-b hover:bg-gray-50">
                        <td class="px-6 py-4 font-medium text-gray-900">${p.iniciativa}</td>
                        <td class="px-6 py-4">${p.responsavel}</td>
                        <td class="px-6 py-4">${p.fluxo}</td>
                        <td class="px-6 py-4">
                            <div class="flex items-center">
                                <div class="w-full bg-gray-200 rounded-full h-2.5 mr-2">
                                    <div class="bg-blue-600 h-2.5 rounded-full" style="width: ${progressPercentage}%"></div>
                                </div>
                                <span>${progressPercentage}%</span>
                            </div>
                        </td>
                        <td class="px-6 py-4">
                            <div class="flex items-center">
                                <span class="farol-dot ${farolColors[p.farol] || 'bg-gray-300'} mr-2"></span>
                                ${p.farol}
                            </div>
                        </td>
                        <td class="px-6 py-4 text-xs">${p.status}</td>
                        <td class="px-6 py-4">${p.gp}</td>
                    </tr>
                `;
                tableBody.innerHTML += row;
            });
        }
    
        // Matriz da Aba 3
        function renderMatrix(filteredData) {
            const dataToRender = filteredData || projectsData;
            document.querySelectorAll('[id^="cell-"]').forEach(cell => cell.innerHTML = '');
    
            dataToRender.forEach(p => {
                if (p.fluxo === '99. Descarte' || !p.impacto || !p.prioridade) return; 
                const cell = document.getElementById(`cell-${p.impacto}-${p.prioridade}`);
                if (cell) {
                    const score = p.impacto + p.prioridade;
                    let bgColor = 'bg-gray-200';
                    if (score <= 3) bgColor = 'bg-blue-200';
                    else if (score === 4) bgColor = 'bg-yellow-200';
                    else if (score >= 5) bgColor = 'bg-green-200';
                    
                    const card = `
                        <div class="p-2 ${bgColor} rounded-md shadow-sm mb-2 text-xs cursor-pointer" title="${p.status}">
                            <p class="font-bold truncate">${p.iniciativa}</p>
                            <p class="text-gray-600">${p.gp} / ${p.responsavel}</p>
                        </div>
                    `;
                    cell.innerHTML += card;
                }
            });
        }
        
        // --- FILTROS ---
        function setupFilters() {
            const gpFilter = document.getElementById('filter-gp');
            const areaFilter = document.getElementById('filter-area');
            
            const gps = [...new Set(projectsData.map(p => p.gp))];
            const areas = [...new Set(projectsData.map(p => p.responsavel))];
    
            gps.sort().forEach(gp => {
                if(gp) gpFilter.innerHTML += `<option>${gp}</option>`;
            });
            areas.sort().forEach(area => {
                if(area) areaFilter.innerHTML += `<option>${area}</option>`;
            });
    
            document.getElementById('filter-gp').addEventListener('change', applyFilters);
            document.getElementById('filter-area').addEventListener('change', applyFilters);
            document.getElementById('filter-status').addEventListener('change', applyFilters);
        }
    
        function applyFilters() {
            const selectedGp = document.getElementById('filter-gp').value;
            const selectedArea = document.getElementById('filter-area').value;
            const selectedStatus = document.getElementById('filter-status').value;
    
            const filteredData = projectsData.filter(p => {
                const gpMatch = selectedGp === 'Todos' || p.gp === selectedGp;
                const areaMatch = selectedArea === 'Todos' || p.responsavel === selectedArea;
                const statusMatch = selectedStatus === 'Todos' || p.farol === selectedStatus;
                return gpMatch && areaMatch && statusMatch;
            });
            renderMatrix(filteredData);
        }
    
        // --- INICIALIZAÇÃO ---
        document.addEventListener('DOMContentLoaded', async () => {
            const dadosCarregados = await carregarDadosDaPlanilha();
    
            if (dadosCarregados && dadosCarregados.length > 0) {
                projectsData = dadosCarregados;
                
                calculateAndRenderMetrics(projectsData);
                renderComplexityChart();
                renderSummaryTable();
                setupFilters();
                applyFilters();
            } else {
                 document.querySelector('main').innerHTML = `
                    <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg relative" role="alert">
                        <strong class="font-bold">Erro ao carregar dados!</strong>
                        <span class="block sm:inline">Não foi possível buscar as informações da planilha. Verifique se o link está correto, se a planilha está publicada na web como CSV e se o delimitador está correto.</span>
                    </div>
                `;
            }
        });
    </script>
</body>
</html>

